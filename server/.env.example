# Database
# For production, add connection pool settings:
# DATABASE_URL="postgresql://user:password@localhost:5432/db?connection_limit=20&pool_timeout=10"
DATABASE_URL="postgresql://user:password@localhost:5432/payment_management"

# =============================================================================
# JWT Configuration
# =============================================================================
# IMPORTANT: Generate secure secrets for production!
# Run: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
#
# Security requirements:
# - Must be at least 32 characters
# - Must not contain common weak patterns (secret, password, changeme, etc.)
# - Should be different for each environment (dev, staging, production)
# =============================================================================

# JWT_SECRET - Required for signing access tokens
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=

# JWT_REFRESH_SECRET - Optional separate secret for refresh tokens
# If not set, falls back to JWT_SECRET
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_REFRESH_SECRET=

# Server
PORT=3000
NODE_ENV=development

# CORS (comma-separated list of allowed origins)
ALLOWED_ORIGINS=http://localhost:5173

# Logging
LOG_LEVEL=info

# Metrics (optional - for production security)
# METRICS_TOKEN=your-secure-metrics-token
# METRICS_ALLOWED_IPS=127.0.0.1,::1,10.0.0.0/8

# =============================================================================
# Invoice Validation Rules Configuration
# =============================================================================
# Environment variables override database settings
# Valid values for ENABLED: true, false (lowercase)
# Restart application after changing these values
# =============================================================================

# DUPLICATE_INVOICE_NUMBER - Prevents duplicate vendor invoice numbers
# Severity: CRITICAL | Default: ENABLED
VALIDATION_RULE_DUPLICATE_INVOICE_NUMBER_ENABLED=true

# MISSING_INVOICE_NUMBER - Flags invoices without invoice numbers
# Severity: WARNING | Default: DISABLED
VALIDATION_RULE_MISSING_INVOICE_NUMBER_ENABLED=false

# AMOUNT_THRESHOLD_EXCEEDED - Flags invoices exceeding amount threshold
# Severity: WARNING | Default: DISABLED
# Threshold: Numeric value (default: 10000)
VALIDATION_RULE_AMOUNT_THRESHOLD_EXCEEDED_ENABLED=false
VALIDATION_RULE_AMOUNT_THRESHOLD_EXCEEDED_THRESHOLD=10000

# ROUND_AMOUNT_PATTERN - Detects suspiciously round amounts (e.g., 5000.00)
# Severity: INFO | Default: DISABLED
# Minimum Amount: Only check amounts above this value (default: 1000)
VALIDATION_RULE_ROUND_AMOUNT_PATTERN_ENABLED=false
VALIDATION_RULE_ROUND_AMOUNT_PATTERN_MINIMUM_AMOUNT=1000

# PRICE_VARIANCE - Detects price variations from historical averages
# Severity: INFO | Default: DISABLED
# Variance Percent: Percentage threshold (default: 15)
# Historical Count: Number of historical prices to average (default: 5)
VALIDATION_RULE_PRICE_VARIANCE_ENABLED=false
VALIDATION_RULE_PRICE_VARIANCE_VARIANCE_PERCENT=15
VALIDATION_RULE_PRICE_VARIANCE_HISTORICAL_COUNT=5

# PO_AMOUNT_VARIANCE - Detects invoice/PO amount discrepancies
# Severity: WARNING | Default: DISABLED
# Variance Percent: Percentage threshold (default: 10)
VALIDATION_RULE_PO_AMOUNT_VARIANCE_ENABLED=false
VALIDATION_RULE_PO_AMOUNT_VARIANCE_VARIANCE_PERCENT=10

# PO_ITEM_MISMATCH - Detects invoice items not in linked PO
# Severity: WARNING | Default: DISABLED
VALIDATION_RULE_PO_ITEM_MISMATCH_ENABLED=false

# DELIVERY_NOTE_MISMATCH - Detects invoice items not in delivery notes
# Severity: WARNING | Default: DISABLED
VALIDATION_RULE_DELIVERY_NOTE_MISMATCH_ENABLED=false

# =============================================================================
# Production Recommended Configuration
# =============================================================================
# Uncomment and customize for production:
#
# VALIDATION_RULE_DUPLICATE_INVOICE_NUMBER_ENABLED=true
# VALIDATION_RULE_AMOUNT_THRESHOLD_EXCEEDED_ENABLED=true
# VALIDATION_RULE_AMOUNT_THRESHOLD_EXCEEDED_THRESHOLD=50000
# VALIDATION_RULE_PO_AMOUNT_VARIANCE_ENABLED=true
# VALIDATION_RULE_PO_AMOUNT_VARIANCE_VARIANCE_PERCENT=5
# VALIDATION_RULE_PO_ITEM_MISMATCH_ENABLED=true
# =============================================================================
